# Инструкция по работе с ssh на виртуалке

## Как вообще подключиться по ssh

Все это делается уже после того как вы разобрались с пользователями и паролями. Как это сделать смотрите в `root-password/README.md`.

1. В настройках виртуалки прокидываем порты. По дефолту ssh работает на `22` порту. Проверить это можно на виртуалке в `/etc/ssh/sshd_config`. Таким образом, прокидываем, например, `2222` порт локалхоста на `22` порт виртуалки. Это делается в настройках сети.
2. Коннектимся при помощи `ssh -p 2222 username@127.0.0.1`. Локалхост потому что у вас виртуалка запущена на локалхосте, очев же.

## Как сделать подключение без пароля

Сначала разбираемся на машине-клиенте.

1. При помощи `ssh-keygen` генерируем ssh ключ. Если вы введете passphrase, то при подключении при помощи ssh вас будут требовать её вводить, не пугайтесь все норм это всё еще подключение по ssh.
2. Копируем публичный ключ (например, `id_rsa.pub`, с разширением `.pub`).

Далее переходим на хост.

1. Пихаем ваш публичный ключ в конец `~/.ssh/authorized_keys`.
2. Опционально, делаем `chmod 700 ~/.ssh` и `chmod 600 ~/.ssh/authorized_keys` для того чтобы приколисты не сломали ничего.
3. `sudo nano /etc/ssh/sshd_config`.
4. 
```
PubkeyAuthentication yes
PasswordAuthentication no
PermitEmptyPasswords no
```
5. `sudo systemctl restart ssh`
6. Готово, подключаемся как в первой части гайда и проверяем работоспособность.